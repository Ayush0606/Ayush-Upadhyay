{%- liquid
  assign grid_heading = section.settings.grid_heading
-%}

{{ 'gift-guide.css' | asset_url | stylesheet_tag }}
{{ 'gift-guide.js' | asset_url | script_tag }}

<!-- Gift Guide Grid Section -->

<div class="gift-guide-grid">
  <div class="gift-guide-grid__container">
    <h2 class="gift-guide-grid__heading">{{ grid_heading }}</h2>
    
    <div class="gift-guide-grid__tiles">
      {%- for block in section.blocks -%}
        {%- if block.settings.product -%}
          {%- assign product = block.settings.product -%}
          <div class="gift-guide-tile" data-product-id="{{ product.id }}">
            <div class="gift-guide-tile__image-wrapper">
              {%- if product.featured_image -%}
                <img 
                  src="{{ product.featured_image | image_url: width: 500 }}" 
                  alt="{{ product.title }}"
                  class="gift-guide-tile__image"
                  loading="lazy"
                >
              {%- else -%}
                <div class="gift-guide-tile__image" style="background: #f0f0f0;"></div>
              {%- endif -%}
              <div class="gift-guide-tile__overlay">
                <button class="gift-guide-tile__badge" type="button" aria-label="View product details">+</button>
              </div>
            </div>
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  </div>
</div>

<!-- Modal Popup -->
<div class="gift-guide-modal-overlay" id="ggModalOverlay">
  <div class="gift-guide-modal" id="ggModal">
    <button class="gift-guide-modal__close" type="button" aria-label="Close modal">&times;</button>
    
    <img id="ggModalImage" class="gift-guide-modal__image" src="" alt="" loading="lazy">
    
    <div class="gift-guide-modal__content">
      <h3 class="gift-guide-modal__title" id="ggModalTitle"></h3>
      <p class="gift-guide-modal__price" id="ggModalPrice"></p>
      <p class="gift-guide-modal__description" id="ggModalDescription"></p>
      
      <div class="gift-guide-modal__variants" id="ggModalVariants"></div>
      
      <button 
        class="gift-guide-modal__add-to-cart" 
        type="button"
        id="ggAddToCartBtn"
      >
        ADD TO CART
      </button>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Gift Guide Grid",
  "settings": [
    {
      "type": "text",
      "id": "grid_heading",
      "label": "Grid Section Heading",
      "default": "Tisso vison in the wild"
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select Product"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Gift Guide Grid",
      "blocks": [
        { "type": "product" },
        { "type": "product" },
        { "type": "product" },
        { "type": "product" },
        { "type": "product" },
        { "type": "product" }
      ]
    }
  ]
}
{% endschema %}
